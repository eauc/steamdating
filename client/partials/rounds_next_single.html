<div class="text-center">
  <button class="btn btn-default"
          ng-class="{
          'btn-info': (new_state.players | players:'areAllPaired':next_round)
          }"
          ng-disabled="!(new_state.players | players:'areAllPaired':next_round)"
          ng-click="registerNextRound()">
    Register Round
  </button>
  <div ng-repeat="(gri,gr) in ::new_state.players">
    <h2 ng-if="::new_state | state:'hasPlayerGroups'"
        style="border-bottom:1px solid black;">
      Group{{::$index+1}}
    </h2>
    <h3 ng-if="new_state | state:'isBracketTournament':gri">
      Bracket - {{::new_state | state:'bracketRoundOf':gri}}
    </h3>
    <table class="table text-center">
      <tr ng-class="{
          'info': (gr | players:'areAllPaired':next_round[gri])
          }">
        <th class="text-center" colspan="3">Player1</th>
        <th class="text-center">Table</th>
        <th class="text-center" colspan="3">Player2</th>
      </tr>
      <tr ng-repeat="(gai, g) in next_round[gri]"
          ng-class="{
          'info': (g | game:'isValid')
          }">
        <td></td>
        <td></td>
        <td>
          <select ng-model="g.p1.name"
                  ng-change="updateNextRound(gri, gai, 'p1')"
                  ng-options="
                  p.name
                  as (!(next_round[gri] | round:'isPlayerPaired':p) ? '>'+p.name : p.name)
                  for p in gr
                  "
                  class="form-control">
            <!-- <option ng-repeat="p in gr track by p.name"
            value="{{p.name}}">
            {{!(next_round[gri] | round:'isPlayerPaired':p) ? '>' : ''}} {{p.name}}
            </option> -->
          </select>
        </td>
        <td>{{::g.table}}</td>
        <td>
          <select ng-model="g.p2.name"
                  ng-change="updateNextRound(gri, gai, 'p2')"
                  ng-options="
                  p.name
                  as (!(next_round[gri] | round:'isPlayerPaired':p) ? '>'+p.name : p.name)
                  for p in gr
                  "
                  class="form-control">
            <!-- <option ng-repeat="p in gr track by p.name"
            value={{p.name}}>
            {{!(next_round[gri] | round:'isPlayerPaired':p) ? '>' : ''}} {{p.name}}
            </option> -->
          </select>
        </td>
        <td></td>
        <td></td>
      </tr>
    </table>
    <button class="btn btn-default"
            ng-click="suggestNextRound(gri, 'sr')"
            ng-if="::!(state | state:'isBracketTournament':gri:state.rounds.length-1)">
      Make SR Suggestion
    </button>
    <button class="btn btn-default"
            ng-click="suggestNextRound(gri, 'bracket')"
            ng-if="::state | state:'canBeBracketTournament':gri"
            >
      Make Bracket Suggestion
    </button>
  </div>
</div>
