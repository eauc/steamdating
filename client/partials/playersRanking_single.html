<div ng-repeat="(gri,gr) in sorted_players">
  <h2 ng-if="::state | state:'hasPlayerGroups'"
      style="border-bottom:1px solid black;">
    Group{{::gri+1}}
  </h2>
  <h3 ng-if="::state | state:'isBracketTournament':gri">
    Bracket - {{::state | state:'bracketRoundOf':gri:state.rounds.length-1}}
  </h3>
  <table class="table"
         style="table-layout:fixed">
    <tr>
      <th style="width:4em;">Rank</th>
      <th>
        Name
      </th>
      <th>Faction</th>
      <th ng-if="state | state:'hasPlayerCustomField'">
        {{::state.custom_fields.player}}
      </th>
      <th>TP</th>
      <th>SoS</th>
      <th>CP</th>
      <th>AP</th>
      <th ng-if="state | state:'hasGameCustomField'">
        {{::state.custom_fields.game}}
      </th>
    </tr>
    <tbody ng-repeat="rank in ::gr"
           style="border-width:0px">
      <tr ng-repeat="p in ::rank.players"
          style="cursor:pointer;"
          ng-click="doEditPlayer(p)">
        <td>{{::rank.rank}}</td>
        <td style="word-wrap:break-word;">{{::p.name}}</td>
        <td style="word-wrap:break-word;">
          <img ng-src="{{::p.faction | factions:'iconFor'}}"
               style="height:1.8em;"/>
          {{::p.faction}}
        </td>
        <td ng-if="state | state:'hasPlayerCustomField'">
          {{::p.custom_field}}
        </td>
        <td>{{::p.points.tournament}}</td>
        <td>{{::p.points.sos}}</td>
        <td>{{::p.points.control}}</td>
        <td>{{::p.points.army}}</td>
        <td ng-if="state | state:'hasGameCustomField'">
          {{::p.points.custom_field}}
        </td>
      </tr>
    </tbody>
  </table>
</div>
